---
import { ViewTransitions, fade } from "astro:transitions";

import { Website, dateToString } from "@lib/meta";
import { Assignee } from "@lib/schema";

import Schema from "@layouts-components/meta/Schema.astro";
import OpenGraphData from "@layouts-components/meta/OpenGraphData.astro";
import TwitterCard from "@layouts-components/meta/TwitterCards.astro";
import Preload from "@components/layouts/meta/Pre.astro";
import Settings from "@layouts-components/meta/Settings.astro";
import Data from "@layouts-components/meta/Data.astro";

export interface Props {
  title: string;
  noIndex: boolean;
  favicon: string;
  fonts?: Array<string>;
  images?: Array<{ format: string; src: string; media?: string }>;
  meta: Website;
  profile?: Assignee | Assignee[];
  author?: Assignee | Assignee[];
  datePublished?: Date | string;
  dateModified?: Date | string;
}

const { title, noIndex, favicon, fonts, images, meta, profile, author, datePublished, dateModified } = Astro.props;
---

<head>
  <ViewTransitions transition:animate={fade({ duration: "0.1s" })} />
  <Schema
    title={title}
    profile={profile}
    author={author}
    datePublished={datePublished instanceof Date ? dateToString(datePublished) : datePublished}
    dateModified={dateModified instanceof Date ? dateToString(dateModified) : dateModified}
  />
  <Data title={title} description={meta.description} authorName={meta.author} siteName={meta.name} url={meta.url} />
  <Settings favicon={favicon} noIndex={noIndex} />
  <Preload fonts={fonts} images={images} />
  <OpenGraphData title={title} siteName={meta.name} image={meta.image} keywords={meta.keywords} />
  <TwitterCard title={title} twitterId={meta.twitterId} image={meta.image} alt={meta.imageAlt} />
  <slot />
</head>
